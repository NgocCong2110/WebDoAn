<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-LN+7fdVzj6u52u30Kp6M/trliBMCMKTyK833zpbD+pXdCLuTusPj697FH4R/5mcr" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ndDqU0Gzau9qJ1lfW4pNLlhNTkCfHzAVBReH9diLvGRem5+R9g2FzA8ZGN954O5Q"
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="TestJS.js"></script>
  <style>
    #GioHang,
    #HomePage {
      display: inline-block;
      position: relative;
      padding-bottom: 4px;
      color: #333;
      text-decoration: none;
      font-weight: bold;
    }

    #HomePage::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 0;
      height: 3px;
      background-color: #2893e0;
      transition: width 0.4s ease;
    }

    #HomePage:hover::after {
      width: 100%;
    }


    #GioHang::after {
      content: "";
      position: absolute;
      left: 0;
      bottom: 0;
      width: 0;
      height: 3px;
      background-color: #2893e0;
      transition: width 0.4s ease;
    }

    #GioHang:hover::after {
      width: 100%;
    }

    /* Mobile interface */
    @media (max-width: 991.98px) {
        #navContent {
          display: none !important;
        }
      }
      #slideMenu {
        position: fixed;
        top: 0;
        left: -250px; /* ẩn đi */
        width: 250px;
        height: 100%;
        background-color: #ffffff;
        box-shadow: 2px 0 6px rgba(0, 0, 0, 0.2);
        z-index: 1050;
        transition: left 0.3s ease;
      }

      #slideMenu.show {
        left: 0;
      }

      #slideMenu a {
        text-decoration: none;
        color: #000;
        font-weight: 500;
        border-bottom: 1px solid #ddd;
      }

      #slideMenu a:hover {
        background-color: #f2f2f2;
      }
  </style>
</head>

<body>
  <header class="p-3 mb-3 border-bottom">
    <div class="container">
      <div
          class="d-flex align-items-center justify-content-between d-lg-none mb-2">
          <button class="btn btn-outline-secondary" id="menuToggle">
            &#9776;
          </button>
          <form role="search" class="flex-grow-1 mx-2">
            <input
              type="search"
              class="form-control"
              placeholder="Search..."
              aria-label="Search" />
          </form>
        </div>

      <div id="navContent" class="d-flex flex-wrap align-items-center justify-content-between gap-2">
        <div class="col-12 col-lg-auto text-center text-lg-start">
          <a href="/" class="d-inline-flex align-items-center mb-2 mb-lg-0 link-body-emphasis text-decoration-none">
            <svg class="bi me-2" width="40" height="32" role="img" aria-label="Bootstrap">
              <use xlink:href="#bootstrap"></use>
            </svg>
          </a>
        </div>
        <div class="col-12 col-lg text-center text-lg-start">
          <ul class="nav justify-content-center justify-content-lg-start mb-0">
            <li>
              <a href="../index.html" class="nav-link px-2 link-secondary" id="HomePage">
                <i class="fa-solid fa-house me-1"></i>Trang Chủ
              </a>
            </li>
          </ul>
        </div>
        <div class="col-12 col-lg">
          <form role="search" class="w-100">
            <input type="search" class="form-control" placeholder="Search..." aria-label="Search" />
          </form>
        </div>

        <div class="col-12 col-lg-auto text-center text-lg-end">
          <a href="" class="nav-link px-2 link-secondary" id="GioHang">
            <i class="fa-solid fa-cart-shopping me-1"></i>Giỏ Hàng
          </a>
        </div>

        <div class="col-12 col-lg-auto text-center text-lg-end">
          <div class="dropdown">
            <a href="#" class="d-inline-block link-body-emphasis text-decoration-none dropdown-toggle"
              data-bs-toggle="dropdown" aria-expanded="false">
              <img src="../images/default-user-image.png" alt="user" width="32" height="32" class="rounded-circle" />
            </a>
            <ul class="dropdown-menu text-small dropdown-menu-end">
              <li>
                <a class="dropdown-item" href="#">Thông tin tài khoản</a>
              </li>
              <li>
                <hr class="dropdown-divider" />
              </li>
              <li><a class="dropdown-item" href="DangNhap.html" id="dangNhap">Đăng Nhập</a></li>
              <li><a class="dropdown-item" href="DangKy.html" id="dangKy">Đăng Ký</a></li>
              <li>
                <a class="dropdown-item" id="dangXuat" onclick="DangXuat()">Đăng Xuất</a>
              </li>
            </ul>
          </div>
        </div>

      </div>
    </div>
  </header>

  <div id="slideMenu">
    <button
      id="closeSlideMenu"
      class="btn btn-close btn-sm ms-auto d-block my-2 me-2"></button>
    <a href="index.html" class="d-block px-3 py-2"
      ><i class="fa-solid fa-house me-1"></i> Trang Chủ</a
    >
    <a href="pages/GioHang.html" id="GioHangSlide" class="d-block px-3 py-2"
      ><i class="fa-solid fa-cart-shopping me-1"></i> Giỏ Hàng</a
    >
    <a href="pages/ThongTinNguoiDung.html" class="d-block px-3 py-2"
      ><i class="fa-solid fa-user"></i> Thông tin</a
    >
    <a href="pages/DangNhap.html" id="dangNhapSlide" class="d-block px-3 py-2"
      ><i class="fa-solid fa-right-to-bracket"></i> Đăng Nhập</a
    >
    <a href="pages/DangKy.html" id="dangKySlide" class="d-block px-3 py-2"
      ><i class="fa-solid fa-registered"></i> Đăng Ký</a
    >
    <a
      href="index.html"
      id="dangXuatSlide"
      onclick="DangXuat()"
      class="d-block px-3 py-2"
      ><i class="fa-solid fa-right-from-bracket"></i> Đăng Xuất</a
    >
  </div>

  <div class="container d-flex justify-content-center align-items-center" style="min-height: 100vh">
    <div class="card profile-card shadow mt-4">
      <div class="card-body text-center">
        <img src="../images/default-user-image.png" alt="User Profile"
          class="rounded-circle profile-img mb-3 w-25 h-25" />
        <h3 class="TenNguoiDung" id="showUsername"></h3>
        <ul class="list-group list-group-flush mb-3">
          <li class="list-group-item bg-transparent">
            <i class="bi bi-envelope-fill me-2" id="EmailNguoiDung"></i>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- <button onclick = "LayThongTin()">click vao
      <p id = "danhsachnguoidung"></p>
    </button> -->
  <script>
    function GetUserName() {
      const users = JSON.parse(localStorage.getItem("currentlogin"));
      if (!users || users.length == 0) {
        document.getElementById("showUsername").innerText = "Chưa đăng nhập"
        return
      };

      const UserName = users.TenNguoiDung;
      const username = document.querySelectorAll(".TenNguoiDung");
      username.forEach((el) => (el.innerText = UserName));
      // const UserInfo = JSON.parse(localStorage.getItem("users"))
      // const UserName = UserInfo.TenNguoiDung
      // const username = document.querySelectorAll(".TenNguoiDung")
      // for (let i = 0; i < username.length; i++) {
      //     username[i].innerHTML = UserName
      // }
    }
    //Lay thong tin nguoi dung khi dang nhap
    function GetUserEmail() {
      const users = JSON.parse(localStorage.getItem("currentlogin"));
      if (!users || users.length === 0) return;

      const UserEmail = users.EmailNguoiDung;
      const emailElement = document.getElementById("EmailNguoiDung");
      if (emailElement) {
        emailElement.innerText = UserEmail;
      }
      // const UserInfo = JSON.parse(localStorage.getItem("users"))
      // const UserEmail = UserInfo.EmailNguoiDung
      // document.getElementById("EmailNguoiDung").innerText = UserEmail
    }

    function DangXuat() {
      const currentUser = localStorage.getItem("currentlogin");
      if (currentUser) {
        localStorage.removeItem("currentlogin");
        window.location.href = "../index.html"
      } else {
        console.log("Khong co user nao!");
      }
    }
    //kiem tra currentLogin gio hang
    const GioHang = document.getElementById("GioHang");

    GioHang.addEventListener("click", function (e) {
      e.preventDefault();
      const currentUser = localStorage.getItem("currentlogin");

      if (currentUser) {
        window.location.href = "GioHang.html";
      } else {
        const check = confirm("Bạn phải có tài khoản mới dùng được tính năng này, bạn có muốn chuyển đến form đăng nhập?")
        if (check == true)
          setInterval(() => {
            window.location.href = "DangNhap.html";
          }, 2000)
      }
    });

    //Khong viet function duoi day
    document.addEventListener("DOMContentLoaded", function () {
      const currentUser = localStorage.getItem("currentlogin");
      
      const menuToggle = document.getElementById("menuToggle");
        const slideMenu = document.getElementById("slideMenu");
        const closeSlideMenu = document.getElementById("closeSlideMenu");

        if (!currentUser) {
          //desktop
          document.getElementById("dangXuat").style.display = "none";
          //mobile
          document
            .getElementById("dangXuatSlide")
            ?.style.setProperty("display", "none", "important");
        } else {
          //desktop
          document.getElementById("dangNhap").style.display = "none";
          document.getElementById("dangKy").style.display = "none";
          //mobile
          document
            .getElementById("dangNhapSlide")
            ?.style.setProperty("display", "none", "important");
          document
            .getElementById("dangKySlide")
            ?.style.setProperty("display", "none", "important");
        }

        menuToggle.addEventListener("click", function () {
          slideMenu.classList.add("show");
        });

        closeSlideMenu.addEventListener("click", function () {
          slideMenu.classList.remove("show");
        });

      GetUserEmail(), GetUserName();
    });
  </script>
</body>

</html>